(()=>{function p(r,e,n){let t=new o(document.getElementById(r));return t.useRenderer(f),t.useRenderer(d),t.useRenderer(l),t.useState(n),t.render(e),t}function h(r){let e=new o(document.getElementById(r));return e.useRenderer(f),e.useRenderer(d),e.useRenderer(l),e}function f(r){let e=document.createElement("button");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(y)):typeof t=="string"&&e.setAttribute(n,t));return e}function d(r){let e=document.createElement("div");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(e)):typeof t=="string"&&e.setAttribute(n,t));return e}function l(r){let e=document.createElement("span");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="value"&&typeof t!="function"&&(e.innerHTML=r.value),n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(s=>console.log(s))):typeof t=="string"&&e.setAttribute(n,t));return e}function y(r){r(window.KaffiState),window.KaffiApp.updateState()}var o=class{constructor(e){this.renderers=new Map;this.textElements=[];this.listeners=[];this.appContainer=e,window.KaffiApp=this}useRenderer(e){this.renderers.set(e.name,e)}render(e){this.appContainer.append(this.renderNode("div",e)),this.updateState()}renderNode(e,n){let t=this.renderers.get(e);t||(t=this.renderers.get("div"));let s=t(this.getNodeProps(n)),c=this.getNodeChildren(n);if(this.containsOnUpdate(n)){let i=this.getNodeProps(n).onUpdate;typeof i=="function"&&this.listeners.push({element:s,stateFunc:i})}if(this.containsText(n)){let i=c.find(([u,m])=>u=="text"),a=this.renderNode("text",i[1]);typeof i[1].value=="function"&&this.textElements.push({element:a,stateFunc:i[1].value}),s.append(a)}else this.getNodeChildren(n).forEach(([i,a])=>{s.appendChild(this.renderNode(i,a))});return s}getNodeProps(e){return Object.fromEntries(Object.entries(e).filter(([n,t])=>typeof t!="object"))}getNodeChildren(e){return Object.entries(e).filter(([n,t])=>typeof t=="object")}containsText(e){return Object.keys(e).some(n=>n=="text")}containsOnUpdate(e){return Object.keys(e).some(n=>n=="onUpdate")}useState(e){window.KaffiState=e}updateState(){this.textElements.forEach(e=>{e.element.innerHTML=e.stateFunc(window.KaffiState)}),this.listeners.forEach(e=>{e.stateFunc(window.KaffiState,e.element)})}};})();
//# sourceMappingURL=lib.js.map
