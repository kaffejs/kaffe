function p(r,e,n){let t=new o(document.getElementById(r));return t.useRenderer("button",d),t.useRenderer("div",f),t.useRenderer("text",l),t.useState(n),t.render(e),t}function h(r){let e=new o(document.getElementById(r));return e.useRenderer("button",d),e.useRenderer("div",f),e.useRenderer("text",l),e}function d(r){let e=document.createElement("button");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(y)):typeof t=="string"&&e.setAttribute(n,t));return e}function f(r){let e=document.createElement("div");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(e)):typeof t=="string"&&e.setAttribute(n,t));return e}function l(r){let e=document.createElement("span");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="value"&&typeof t!="function"&&(e.innerHTML=r.value),n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(s=>console.log(s))):typeof t=="string"&&e.setAttribute(n,t));return e}function y(r){r(window.kaffeState),window.kaffeApp.updateState()}var o=class{constructor(e){this.renderers=new Map;this.textElements=[];this.listeners=[];this.appContainer=e,window.kaffeApp=this}useRenderer(e,n){this.renderers.set(e,n)}render(e){this.appContainer.append(this.renderNode("div",e)),this.updateState()}renderNode(e,n){let t=this.renderers.get(e);t||(t=this.renderers.get("div"));let s=t(this.getNodeProps(n)),u=this.getNodeChildren(n);if(this.containsOnUpdate(n)){let i=this.getNodeProps(n).onUpdate;typeof i=="function"&&this.listeners.push({element:s,stateFunc:i})}if(this.containsText(n)){let i=u.find(([c,m])=>c=="text"),a=this.renderNode("text",i[1]);typeof i[1].value=="function"&&this.textElements.push({element:a,stateFunc:i[1].value}),s.append(a)}else this.getNodeChildren(n).forEach(([i,a])=>{s.appendChild(this.renderNode(i,a))});return s}getNodeProps(e){return Object.fromEntries(Object.entries(e).filter(([n,t])=>typeof t!="object"))}getNodeChildren(e){return Object.entries(e).filter(([n,t])=>typeof t=="object")}containsText(e){return Object.keys(e).some(n=>n=="text")}containsOnUpdate(e){return Object.keys(e).some(n=>n=="onUpdate")}useState(e){window.kaffeState=e}updateState(){this.textElements.forEach(e=>{e.element.innerHTML=e.stateFunc(window.kaffeState)}),this.listeners.forEach(e=>{e.stateFunc(window.kaffeState,e.element)})}};export{d as button,h as createApp,p as default,f as div,l as text};
//# sourceMappingURL=lib.js.map
