function y(r,e,n){let t=new f(document.getElementById(r));return t.useRenderer("button",l),t.useRenderer("div",u),t.useRenderer("text",c),t.useState(n),t.render(e),t}function h(r){let e=new f(document.getElementById(r));return e.useRenderer("button",l),e.useRenderer("div",u),e.useRenderer("text",c),e}function l(r){let e=document.createElement("button");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(d)):typeof t=="string"&&e.setAttribute(n,t));return e}function u(r){let e=document.createElement("div");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(d)):typeof t=="string"&&e.setAttribute(n,t));return e}function c(r){let e=document.createElement("span");for(let[n,t]of Object.entries(r))n!="onUpdate"&&(n=="value"&&typeof t!="function"&&(e.innerHTML=r.value),n=="click"&&typeof t=="function"?e.addEventListener("click",()=>t(d)):typeof t=="string"&&e.setAttribute(n,t));return e}function d(r){r(window.kaffeState),window.kaffeApp.updateState()}var f=class{constructor(e){this.renderers=new Map;this.textElements=[];this.listeners=[];this.appContainer=e,window.kaffeApp=this}useRenderer(e,n){this.renderers.set(e,n)}render(e){this.appContainer.append(this.renderNode("div",e)),this.updateState()}renderNode(e,n){let t=this.renderers.get(e);t||(t=this.renderers.get("div"));let a=t(this.getNodeProps(n)),s=this.getNodeChildren(n);if(this.containsOnUpdate(n)){let i=this.getNodeProps(n).onUpdate;typeof i=="function"&&this.listeners.push({element:a,stateFunc:i})}if(this.containsText(n)){let i=s.find(([p,m])=>p=="text"),o=this.renderNode("text",i[1]);typeof i[1].value=="function"&&this.textElements.push({element:o,stateFunc:i[1].value}),a.append(o)}else this.getNodeChildren(n).forEach(([i,o])=>{i.includes("#")&&(i=i.split("#")[0]),a.appendChild(this.renderNode(i,o))});return a}getNodeProps(e){return Object.fromEntries(Object.entries(e).filter(([n,t])=>typeof t!="object"))}getNodeChildren(e){return Object.entries(e).filter(([n,t])=>typeof t=="object")}containsText(e){return Object.keys(e).some(n=>n=="text")}containsOnUpdate(e){return Object.keys(e).some(n=>n=="onUpdate")}useState(e){window.kaffeState=e}updateState(){this.textElements.forEach(e=>{e.element.innerHTML=e.stateFunc(window.kaffeState)}),this.listeners.forEach(e=>{e.stateFunc(window.kaffeState,e.element)})}};function E(r,e,n){let t=window.kaffeApp??null;if(!t)throw new Error("Kaffe instance not found!");r.innerHTML="",e.map((s,i)=>t.renderNode("div",n(s,i))).forEach(s=>r.appendChild(s))}export{l as button,E as children,h as createApp,y as default,u as div,c as text};
//# sourceMappingURL=lib.js.map
